{% extends "base.njk" %}

{% set title %}{% if homes[property_id].rent.status == 'rent' %}{{ homes[property_id].building.property_type or 'Property' }} for Rent in {{ homes[property_id].address.city_name or homes[property_id].unormalized_address.city_name or '' }}, {{ homes[property_id].address.state_code or homes[property_id].unormalized_address.state_code or '' }} - {{ homes[property_id].building.bedrooms or 'N/A' }} beds{% else %}{{ homes[property_id].building.property_type or 'Property' }} for Sale in {{ homes[property_id].address.city_name or homes[property_id].unormalized_address.city_name or '' }}, {{ homes[property_id].address.state_code or homes[property_id].unormalized_address.state_code or '' }} - {{ homes[property_id].building.bedrooms or 'N/A' }} beds{% endif %}{% endset %}

{% set description %}{% if homes[property_id].rent.status == 'rent' %}Rent this {{ homes[property_id].building.bedrooms or 'N/A' }}-bed, {{ homes[property_id].building.bathrooms or 'N/A' }}-bath property in {{ homes[property_id].address.city_name or homes[property_id].unormalized_address.city_name or '' }}, {{ homes[property_id].address.state_code or homes[property_id].unormalized_address.state_code or '' }}{% if homes[property_id].building.total_sqft or homes[property_id].building.living_sqft %}, {{ homes[property_id].building.total_sqft or homes[property_id].building.living_sqft }} sqft{% endif %}. {{ homes[property_id].address.full_address or homes[property_id].unormalized_address.full_address or 'this property' }}{% else %}{{ homes[property_id].building.bedrooms or 'N/A' }}-bed, {{ homes[property_id].building.bathrooms or 'N/A' }}-bath property for sale in {{ homes[property_id].address.city_name or homes[property_id].unormalized_address.city_name or '' }}, {{ homes[property_id].address.state_code or homes[property_id].unormalized_address.state_code or '' }}{% if homes[property_id].building.total_sqft or homes[property_id].building.living_sqft %}, {{ homes[property_id].building.total_sqft or homes[property_id].building.living_sqft }} sqft{% endif %}. {{ homes[property_id].address.full_address or homes[property_id].unormalized_address.full_address or 'this property' }}{% endif %}{% endset %}

{% set canonical %}{{ config.domain }}/homes/{{ property_id }}{% endset %}
{% set og_url %}{{ config.domain }}/homes/{{ property_id }}{% endset %}
{% set twitter_url %}{{ config.domain }}/homes/{{ property_id }}{% endset %}

{% set content %}
<a href="#main-content" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;">Skip to main content</a>

<!-- Navigation -->
<nav class="navigation">
    <div class="nav-content">
        <div class="nav-tabs">
            <a href="#property-history" class="nav-tab">Property History</a>
            <a href="#floorplan" class="nav-tab">Floorplan</a>
            <a href="#building-details" class="nav-tab">Building Details</a>
            <a href="#features" class="nav-tab">Property Features</a>
        </div>
    </div>
</nav>

<div class="container">
    <div class="main-layout" id="main-content">
        <!-- Main Content -->
        <div class="main-content">
            <nav class="breadcrumb" aria-label="Breadcrumb">
                <ol class="breadcrumb">
                    <li><a href="/" class="elephant-link">elephant.xyz</a></li>
                </ol>
            </nav>

            <!-- Property Header -->
            <header class="property-header">
                <div class="property-address">
                    <h1>
                        {% if homes[property_id].address %}
                            {% if homes[property_id].address.street_number %}{{ homes[property_id].address.street_number }}{% endif %}
                            {% if homes[property_id].address.street_pre_directional_text %}{{ homes[property_id].address.street_pre_directional_text }}{% endif %}
                            {% if homes[property_id].address.street_name %}{{ homes[property_id].address.street_name }}{% endif %}
                            {% if homes[property_id].address.street_suffix_type and (homes[property_id].address.street_suffix_type | lower | trim not in (homes[property_id].address.street_name | lower | trim)) %}{{ homes[property_id].address.street_suffix_type }}{% endif %}
                            {% if homes[property_id].address.street_post_directional_text %}{{ homes[property_id].address.street_post_directional_text }}{% endif %}
                            {% if homes[property_id].address.unit_identifier and homes[property_id].address.unit_identifier != 'NA' %}, {{ homes[property_id].address.unit_identifier }}{% endif %}
                            {% if homes[property_id].address.city_name %}, {{ homes[property_id].address.city_name }}{% endif %}
                            {% if homes[property_id].address.state_code %}, {{ homes[property_id].address.state_code }}{% endif %}
                            {% if homes[property_id].address.postal_code %}{{ homes[property_id].postCode }}{% endif %}{% if homes[property_id].address.source_http_request %}<sup class="data-footnote"><a href="#addresssrc" style="color:inherit;text-decoration:none;">1</a></sup>{% endif %}
                        {% else %}
                            {{ homes[property_id].unormalized_address.full_address }}
                        {% endif %}
                    </h1>
                    
                    {% if homes[property_id].address %}
                        {% if homes[property_id].address.county_name %}
                        <div class="county-info">
                            <span>{{ homes[property_id].address.county_name }} County</span>
                            {% if homes[property_id].address.latitude or homes[property_id].address.longitude %}
                            <img src="{{ 'ellipse-7.svg' | assetUrl }}" alt="">
                            {% endif %}
                        </div>
                        {% endif %}
                        {% if homes[property_id].address.latitude or homes[property_id].address.longitude %}
                        <div class="address-coordinates">
                            {% if homes[property_id].address.latitude %}{{ homes[property_id].address.latitude }}{% endif %}
                            {% if homes[property_id].address.longitude %}, {{ homes[property_id].address.longitude }}{% endif %}
                        </div>
                        {% endif %}
                    {% endif %}
                    {% if homes[property_id].rent.status == 'rent' %}
                    <div class="status-badge">
                        <div class="status-dot"></div>
                        <span class="status-text">For Rent</span>
                    </div>
                    {% endif %}

                    {% if homes[property_id].rent.full_furnished %}
                    <div class="status-badge badge-furnished">
                        <img src="{{ 'type=living.svg' | assetUrl }}" alt="Fully Furnished" class="furnished-icon">
                        <span class="status-text">Fully Furnished</span>
                    </div>
                    {% endif %}
                </div>
            </header>

            <!-- Property History Section -->
            <section id="property-history" class="property-history-section scroll-offset-section">
                <h2 class="section-title">Property History</h2>

                <div class="property-history-data-points">
                    {% set sales_count = 0 %}
                    {% for sale in homes[property_id].all_sales %}
                        {% if loop.index <= 3 %}
                            {% set sales_count = sales_count + 1 %}
                            <div class="history-data-item">
                                <div class="history-item-divider"></div>
                                <div class="history-item-content">
                                    <span class="history-label">Sale {{ loop.index }}:</span>
                                    <span class="history-value">
                                        {% if sale.data.sales_transaction_amount %}
                                            ${{ sale.data.sales_transaction_amount | number }}
                                        {% elif sale.data.purchase_price_amount %}
                                            ${{ sale.data.purchase_price_amount | number }}
                                        {% else %}
                                            N/A
                                        {% endif %}
                                    </span>
                                    {% if sale.data.sales_date or sale.data.ownership_transfer_date %}
                                        <span class="history-date">
                                            ({{ sale.data.sales_date or sale.data.ownership_transfer_date | date('MMMM YYYY') }})
                                        </span>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </section>

            <!-- Building Details Section -->
            <section id="building-details" class="building-details-section scroll-offset-section">
                <h2 class="section-title">Building Details</h2>
                
                <div class="building-details-data-points">
                    {% if homes[property_id].building.bedrooms %}
                    <div class="building-data-item">
                        <div class="building-item-divider"></div>
                        <div class="building-item-content">
                            <span class="building-label">Bedrooms:</span>
                            <span class="building-value">{{ homes[property_id].building.bedrooms }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if homes[property_id].building.bathrooms %}
                    <div class="building-data-item">
                        <div class="building-item-divider"></div>
                        <div class="building-item-content">
                            <span class="building-label">Bathrooms:</span>
                            <span class="building-value">{{ homes[property_id].building.bathrooms }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if homes[property_id].building.total_sqft or homes[property_id].building.living_sqft %}
                    <div class="building-data-item">
                        <div class="building-item-divider"></div>
                        <div class="building-item-content">
                            <span class="building-label">Square Feet:</span>
                            <span class="building-value">{{ homes[property_id].building.total_sqft or homes[property_id].building.living_sqft | number }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if homes[property_id].building.property_type %}
                    <div class="building-data-item">
                        <div class="building-item-divider"></div>
                        <div class="building-item-content">
                            <span class="building-label">Property Type:</span>
                            <span class="building-value">{{ homes[property_id].building.property_type }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </section>

            <!-- Tax Information Section -->
            {% if homes[property_id].all_taxes and homes[property_id].all_taxes.length > 0 %}
            <section id="tax-info" class="tax-info-section scroll-offset-section">
                <h2 class="section-title">Tax Information</h2>
                
                {% set first_tax = homes[property_id].all_taxes[0].data %}
                <div class="tax-data-points">
                    {% if first_tax.property_assessed_value_amount %}
                    <div class="tax-data-item">
                        <div class="tax-item-divider"></div>
                        <div class="tax-item-content">
                            <span class="tax-label">Assessed Value:</span>
                            <span class="tax-value">${{ first_tax.property_assessed_value_amount | number }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if first_tax.property_market_value_amount %}
                    <div class="tax-data-item">
                        <div class="tax-item-divider"></div>
                        <div class="tax-item-content">
                            <span class="tax-label">Market Value:</span>
                            <span class="tax-value">${{ first_tax.property_market_value_amount | number }}</span>
                        </div>
                    </div>
                    {% endif %}
                    
                    {% if first_tax.tax_year %}
                    <div class="tax-data-item">
                        <div class="tax-item-divider"></div>
                        <div class="tax-item-content">
                            <span class="tax-label">Tax Year:</span>
                            <span class="tax-value">{{ first_tax.tax_year }}</span>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </section>
            {% endif %}
        </div>
    </div>
</div>
{% endset %}